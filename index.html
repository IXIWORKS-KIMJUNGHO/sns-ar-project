<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¨ëˆ„ë¦¬êµíšŒ 40ì£¼ë…„ AR</title>
    
    <!-- AR.jsì™€ A-Frame ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.min.js"></script>
    
    <!-- ìŠ¤íƒ€ì¼ì‹œíŠ¸ -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- ë©”íƒ€ íƒœê·¸ -->
    <meta name="description" content="ì˜¨ëˆ„ë¦¬êµíšŒ 40ì£¼ë…„ ê±´ë¬¼ ë³€ì²œì‚¬ë¥¼ ARë¡œ ì²´í—˜í•´ë³´ì„¸ìš”">
</head>

<body>
    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loading-screen">
        <div class="loading-content">
            <h2>ì˜¨ëˆ„ë¦¬êµíšŒ 40ì£¼ë…„ AR</h2>
            <p>ì¹´ë©”ë¼ë¥¼ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- AR ì¥ë©´ -->
    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false">
        
        <!-- ìì‚°ë“¤ ë¯¸ë¦¬ ë¡œë“œ -->
        <a-assets>
            <!-- 3D ëª¨ë¸ë“¤ -->
            <a-asset-item id="church-model" src="assets/models/church-current.glb"></a-asset-item>
            
            <!-- ë§ˆì»¤ íŒ¨í„´ë“¤ -->
            <!-- ê¸°ë³¸ Hiro ë§ˆì»¤ ì‚¬ìš© (ë‚˜ì¤‘ì— ì»¤ìŠ¤í…€ ë§ˆì»¤ë¡œ êµì²´) -->
        </a-assets>

        <!-- AR ë§ˆì»¤ -->
        <a-marker 
            preset="hiro" 
            id="main-marker"
            raycaster="objects: .clickable"
            emitevents="true"
            cursor="fuse: false; rayOrigin: mouse;">
            
            <!-- 3D êµíšŒ ëª¨ë¸ (ê¸°ë³¸ì ìœ¼ë¡œëŠ” ê°„ë‹¨í•œ ë°•ìŠ¤) -->
            <a-box 
                id="church-object"
                position="0 0.5 0" 
                rotation="0 45 0"
                scale="1 1 1"
                material="color: #8B4513; roughness: 0.8"
                animation="property: rotation; to: 0 405 0; loop: true; dur: 10000"
                class="clickable">
            </a-box>
            
            <!-- ì •ë³´ í…ìŠ¤íŠ¸ -->
            <a-text 
                id="info-text"
                value="ì˜¨ëˆ„ë¦¬êµíšŒ&#10;1984ë…„ ì„¤ë¦½"
                position="0 2 0"
                align="center"
                color="#FFFFFF"
                shader="msdf"
                font="roboto">
            </a-text>
        </a-marker>

        <!-- ì¹´ë©”ë¼ -->
        <a-entity camera look-controls-enabled="false"></a-entity>
    </a-scene>

    <!-- App Title (Top Center) -->
    <div id="app-title" class="glass-subtle">
        <div class="app-title-content">ì˜¨ëˆ„ë¦¬êµíšŒ 40ì£¼ë…„ AR</div>
    </div>

    <!-- Primary Action - Photo Capture (Right Side) -->
    <div id="primary-action">
        <button id="capture-btn" class="capture-button glass-primary">
            <span>ğŸ“·</span>
        </button>
    </div>

    <!-- AR Status Indicator (Bottom Left) -->
    <div id="ar-status" class="glass-subtle">
        <div class="status-indicator scanning"></div>
        <span class="status-text">ë§ˆì»¤ë¥¼ ì°¾ëŠ” ì¤‘...</span>
    </div>

    <!-- Info Panel (Bottom Center) - Shows when marker detected -->
    <div id="info-panel" class="glass-primary">
        <div class="info-content">
            <h4 id="period-title">ì˜¨ëˆ„ë¦¬êµíšŒ 40ì£¼ë…„</h4>
            <p id="period-description">
                ë§ˆì»¤ë¥¼ ì¸ì‹í•˜ë©´ êµíšŒì˜ ì—­ì‚¬ë¥¼ ARë¡œ ì²´í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
        </div>
    </div>

    <!-- AR Guide Modal -->
    <div id="marker-guide">
        <div class="guide-content glass-primary">
            <h3>AR ì²´í—˜ ë°©ë²•</h3>
            <p>1. ì¹´ë©”ë¼ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”</p>
            <p>2. Hiro ë§ˆì»¤ë¥¼ ì¹´ë©”ë¼ì— ë¹„ì¶°ë³´ì„¸ìš”</p>
            <p>3. 3D êµíšŒ ëª¨ë¸ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤!</p>
            <button id="close-guide">ì‹œì‘í•˜ê¸°</button>
        </div>
    </div>

    <!-- JavaScript íŒŒì¼ë“¤ ë¡œë“œ -->
    <script src="js/ar-controller.js"></script>

    <script>
        // ê¸°ë³¸ ì´ˆê¸°í™” ì½”ë“œ
        document.addEventListener('DOMContentLoaded', function() {
            // ë¡œë”© í™”ë©´ ìˆ¨ê¸°ê¸°
            setTimeout(() => {
                document.getElementById('loading-screen').style.display = 'none';
            }, 2000);

            // ê°€ì´ë“œ íŒ¨ë„ ë‹«ê¸°
            document.getElementById('close-guide').addEventListener('click', function() {
                document.getElementById('marker-guide').style.display = 'none';
            });

            // ì‚¬ì§„ ì´¬ì˜ ê¸°ëŠ¥ (ê¸°ë³¸)
            document.getElementById('capture-btn').addEventListener('click', function() {
                // ë‚˜ì¤‘ì— ìŠ¤í¬ë¦°ìƒ· ê¸°ëŠ¥ êµ¬í˜„
                alert('ì‚¬ì§„ ì´¬ì˜ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤!');
            });
        });

        // AR Status Management
        function updateARStatus(status, text) {
            const indicator = document.querySelector('.status-indicator');
            const statusText = document.querySelector('.status-text');
            
            // Remove all status classes
            indicator.classList.remove('scanning', 'error');
            
            // Add new status class
            if (status !== 'found') {
                indicator.classList.add(status);
            }
            
            statusText.textContent = text;
        }

        // AR ë§ˆì»¤ ê°ì§€ ì´ë²¤íŠ¸
        AFRAME.registerComponent('marker-handler', {
            init: function() {
                this.el.addEventListener('markerFound', function() {
                    console.log('ë§ˆì»¤ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤!');
                    
                    // Update AR status
                    updateARStatus('found', 'ë§ˆì»¤ ì¸ì‹ë¨');
                    
                    // Show info panel with animation
                    const infoPanel = document.getElementById('info-panel');
                    infoPanel.style.display = 'block';
                    infoPanel.classList.add('spring-enter');
                    
                    // Update info content for detected marker
                    document.getElementById('period-title').textContent = 'êµíšŒ ì„¤ë¦½ (1984ë…„)';
                    document.getElementById('period-description').textContent = 'ì˜¨ëˆ„ë¦¬êµíšŒê°€ í•˜ë‚˜ë‹˜ì˜ ì€í˜œ ê°€ìš´ë° ì²« ê±¸ìŒì„ ë‚´ë”›ì—ˆìŠµë‹ˆë‹¤. ARë¡œ êµíšŒì˜ ì„±ì¥ ê³¼ì •ì„ ì²´í—˜í•´ë³´ì„¸ìš”.';
                });

                this.el.addEventListener('markerLost', function() {
                    console.log('ë§ˆì»¤ë¥¼ ìƒì—ˆìŠµë‹ˆë‹¤.');
                    
                    // Update AR status
                    updateARStatus('scanning', 'ë§ˆì»¤ë¥¼ ì°¾ëŠ” ì¤‘...');
                    
                    // Hide info panel
                    const infoPanel = document.getElementById('info-panel');
                    infoPanel.style.display = 'none';
                    infoPanel.classList.remove('spring-enter');
                });
            }
        });

        // ë§ˆì»¤ì— ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
        document.querySelector('#main-marker').setAttribute('marker-handler', '');
    </script>
</body>
</html>