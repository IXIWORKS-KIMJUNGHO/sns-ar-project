<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì»¤ìŠ¤í…€ ë§ˆì»¤ í…ŒìŠ¤íŠ¸</title>
    
    <!-- AR.jsì™€ A-Frame ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.min.js"></script>
    
    <!-- ìŠ¤íƒ€ì¼ì‹œíŠ¸ -->
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- AR ì¥ë©´ - ì»¤ìŠ¤í…€ ë§ˆì»¤ ë²„ì „ -->
    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false">
        
        <!-- ìì‚°ë“¤ ë¯¸ë¦¬ ë¡œë“œ -->
        <a-assets>
            <!-- 3D ëª¨ë¸ë“¤ -->
            <a-asset-item id="church-model" src="assets/models/church-current.glb"></a-asset-item>
        </a-assets>

        <!-- ì»¤ìŠ¤í…€ ë§ˆì»¤ (íŒ¨í„´ íŒŒì¼ ì—…ë¡œë“œ í›„ ì‚¬ìš©) -->
        <!--
        <a-marker 
            type="pattern" 
            url="assets/markers/onnuri-church.patt"
            id="custom-marker"
            raycaster="objects: .clickable"
            emitevents="true">
        -->
        
        <!-- ì„ì‹œë¡œ Hiro ë§ˆì»¤ ìœ ì§€ -->
        <a-marker 
            preset="hiro" 
            id="main-marker"
            raycaster="objects: .clickable"
            emitevents="true">
            
            <!-- 3D êµíšŒ ëª¨ë¸ -->
            <a-box 
                id="church-object"
                position="0 0.5 0" 
                rotation="0 45 0"
                scale="1 1 1"
                material="color: #8B4513; roughness: 0.8"
                animation="property: rotation; to: 0 405 0; loop: true; dur: 10000"
                class="clickable">
            </a-box>
            
            <!-- ì •ë³´ í…ìŠ¤íŠ¸ -->
            <a-text 
                id="info-text"
                value="ì˜¨ëˆ„ë¦¬êµíšŒ ì»¤ìŠ¤í…€ ë§ˆì»¤&#10;í…ŒìŠ¤íŠ¸ ì¤‘..."
                position="0 2 0"
                align="center"
                color="#FFFFFF"
                shader="msdf"
                font="roboto">
            </a-text>
        </a-marker>

        <!-- ì¹´ë©”ë¼ -->
        <a-entity camera look-controls-enabled="false"></a-entity>
    </a-scene>

    <!-- UI ìš”ì†Œë“¤ (ê¸°ì¡´ê³¼ ë™ì¼) -->
    <div id="app-title" class="glass-subtle">
        <div class="app-title-content">ì»¤ìŠ¤í…€ ë§ˆì»¤ í…ŒìŠ¤íŠ¸</div>
    </div>

    <div id="primary-action">
        <button id="capture-btn" class="capture-button glass-primary">
            <span class="camera-icon">ğŸ“·</span>
        </button>
    </div>

    <div id="ar-status" class="glass-subtle">
        <div class="status-indicator scanning"></div>
        <span class="status-text">ë§ˆì»¤ë¥¼ ì°¾ëŠ” ì¤‘...</span>
    </div>

    <!-- ì»¤ìŠ¤í…€ ë§ˆì»¤ ì•ˆë‚´ -->
    <div id="marker-guide">
        <div class="guide-content glass-primary">
            <h3>ì»¤ìŠ¤í…€ ë§ˆì»¤ ì„¤ì • ë°©ë²•</h3>
            <p>1. https://jeromeetienne.github.io/AR.js/three.js/examples/marker-training/examples/generator.html ì—ì„œ ë§ˆì»¤ ìƒì„±</p>
            <p>2. ìƒì„±ëœ .patt íŒŒì¼ì„ assets/markers/ í´ë”ì— ì €ì¥</p>
            <p>3. HTMLì—ì„œ preset="hiro"ë¥¼ type="pattern" url="ê²½ë¡œ"ë¡œ ë³€ê²½</p>
            <p>í˜„ì¬ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ Hiro ë§ˆì»¤ë¥¼ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤.</p>
            <button id="close-guide">í™•ì¸</button>
        </div>
    </div>

    <!-- JavaScript íŒŒì¼ë“¤ ë¡œë“œ -->
    <script src="js/ar-controller.js"></script>

    <script>
        // ê¸°ë³¸ ì´ˆê¸°í™” ì½”ë“œ
        document.addEventListener('DOMContentLoaded', function() {
            // ê°€ì´ë“œ íŒ¨ë„ ë‹«ê¸°
            document.getElementById('close-guide').addEventListener('click', function() {
                document.getElementById('marker-guide').style.display = 'none';
            });

            // ì‚¬ì§„ ì´¬ì˜ ê¸°ëŠ¥
            document.getElementById('capture-btn').addEventListener('click', function() {
                if (window.arController && window.arController.isMarkerVisible) {
                    window.arController.captureScreenshot();
                } else {
                    alert('ë§ˆì»¤ë¥¼ ì¸ì‹í•œ í›„ ì‚¬ì§„ì„ ì´¬ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                }
            });
        });

        // ë§ˆì»¤ì— ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
        document.querySelector('#main-marker').setAttribute('marker-handler', '');
    </script>
</body>
</html>